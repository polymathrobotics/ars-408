variables:
  VCS_ARGS: --recursive

include:
- project: 'polymathrobotics/ci/ci_templates'
  ref: main
  file: '/ros/ros1_container/containerize.impl.yml'
- project: 'polymathrobotics/ci/ci_templates'
  ref: main
  file: '/ros/ros2_container/containerize.impl.yml'
- project: 'polymathrobotics/ci/ci_templates'
  ref: main
  file: '/docker-bake/bake_and_push_arm64.yml'
- project: 'polymathrobotics/ci/ci_templates'
  ref: main
  file: '/common/rules.yml'
- project: 'polymathrobotics/ci/ci_templates'
  ref: main
  file: '/common/stages.yml'

stages:
  - build

build_ars408_humble:
  variables:
    DOCKER_IMAGE_NAME: /ars-408
    DOCKER_TAG: humble
    DOCKER_PUSH: --push
    DOCKERFILE_DIR: ars-408
  stage: build
  extends: .ros2_containerize
  only:
    - main

bake_ars408_arm64:
  variables:
    BAKE_PUSH: --push
    BAKE_TARGET: arm64
  extends: .bake_and_push_arm64
  only:
    - main
